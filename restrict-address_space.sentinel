import "tfplan/v2" as tfplan

violations = []

vnets = tfplan.resources["azurerm_virtual_network"]

if vnets is not null {
    for name, vnet in vnets {
        address_space := vnet.applied.address_space

        if address_space is null or length(address_space) == 0 {
            violations.append(
                "La VNet " + name + " debe tener definido el atributo address_space."
            )
        }
    }
}

main = rule {
    length(violations) is 0
}
